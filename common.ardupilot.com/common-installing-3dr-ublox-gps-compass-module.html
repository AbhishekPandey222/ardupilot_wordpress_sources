<!-- 
START METADATA - Only title should be translated 
slug: common-installing-3dr-ublox-gps-compass-module 
title: common-3DR UBlox GPS + Compass Module 
id: 333 
menu_order: 10 
post_parent_id: 0 
post_parent_stub:  
post_parent_title:  
END METADATA 
-->
This page covers the installation of the <a href="http://store.3drobotics.com/products/3dr-gps-ublox-with-compass">3DR UBlox GPS + Compass module</a>.
<!--more-->
<h1>Overview</h1>
The <em>3DR UBlox GPS + Compass module</em> is the recommended GPS for Pixhawk, PX4 and APM2.6 (and above) flight controllers using Plane, Rover and Copter.  These come set-up with <a href="common-ublox-gps/">the best known GPS configuration</a> and have been thoroughly tested by thousands of users.

<img class="alignnone size-full wp-image-2598" src="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_TopAndSide.jpg" alt="GPS_TopAndSide" width="690" height="297" />
<h1>Connecting the Autopilot</h1>
<h2>Connecting to Pixhawk</h2>
Connect the GPS's 6-pin DF13 connector to the Pixhawk's "GPS" port and the compass's 4-pin connector to the I2C port.  Alternatively the compass can be first connected through an <a href="http://www.ebay.com/sch/i.html?_from=R40&amp;_trksid=p2050601.m570.l1313.TR0.TRC0.H0.Xpixhawk+i2c+splitter.TRS0&amp;_nkw=pixhawk+i2c+splitter&amp;_sacat=0" target="_blank">I2C splitter</a> if other I2C devices are to be attached.
<a href="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_Pixhawk_Dual.png"><img class="alignnone size-full wp-image-2600" src="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_Pixhawk_Dual.png" alt="GPS_Pixhawk_Dual" width="985" height="834" /></a>

[note]As of Copter 3.2 and recent versions of Plane and Rover, a secondary GPS can be connected to the Pixhawk’s Serial 4/5 port. Limited testing suggests that a secondary GPS can reduce the likelihood that GPS glitches will affect the vehicle, but can also lead to sudden movements of the vehicle when the primary GPS switches.[/note][tip]On Copter we do not recommend using a second compass due to these sudden vehicle movements.[/tip]

If the parameters are set-up as shown below, the flight controller will use the GPS with the higher number of satellites (Note: it will switch when one GPS has at least 2 more satellites than the other).
<ul>
	<li>GPS_AUTO_SWITCH = 1</li>
	<li>GPS_TYPE2 = 1</li>
</ul>


<a href="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_MPSetup_Dual.jpg"><img class="alignnone size-large wp-image-2601" src="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_MPSetup_Dual-1024x497.jpg" alt="GPS_MPSetup_Dual" width="584" height="283" /></a>

If using Copter 3.3 or higher or recent versions of Plane/Rover then this parameter should also be set:
<ul>
	<li>SERIAL4_PROTOCOL = 5</li>
</ul>
[note]The baud rate is set by the UBlox driver (setting <code>SERIAL4_BAUD = 38</code> is ignored).[/note]

[note]ArduPilot supports up to 3 compasses. However you cannot attach a secondary external compass to Pixhawk because there isn't a spare port.[/note]


<h2>Connecting to APM 2.x</h2>
APM 2.6 is compatible with the <em>3DR UBlox GPS + Compass module</em>.

To connect the GPS module to APM 2.6, attach the GPS port to the APM GPS port using the included 5-position-to-6-position cable (use the top-entry port, not the side-entry port), and attach the GPS MAG port to the APM I<sup>2</sup>C port using the included 4-position cable.

<a href="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/06/gps-to-apm-wiring-web.jpg"><img class="alignnone wp-image-2444" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/06/gps-to-apm-wiring-web.jpg" alt="Connect GPS to APM 2.6." width="500" height="430" /></a>

APM 2.5 and APM 2.0 have an internal compass (unlike APM 2.6) which must be disabled by cutting a trace before you can connect the <em>3DR UBlox GPS + Compass module</em> (the <a href="http://www.youtube.com/watch?v=niqvBmXeNjU">video here</a> shows how).

Other than disabling the internal compass, connecting the UBlox is the same for APM2.0/APM2.5 as for APM2.6.

[note]After connecting the external compass you will need to re-calibrate the compass [site wiki="copter" inline="on"] including <a href="common-compass-setup-advanced/#compassmot_compensation_for_interference_from_the_power_wires_escs_and_motors">Compassmot</a>[/site] (if you had run this procedure for the internal compass).[/note]
<h2>Connecting to PX4</h2>
<ul>
	<li>To connect GPS part of the this module to PX4, connect the GPS port to the PX4FMU’s GPS connector.</li>
	<li>Connect the compass lead on the module to the PX4IO’s I2C port.</li>
	<li>The PX4IO board I2C port is the 4 pin connector located on the board side opposite the Servo Out connectors in the second row of connectors in and next to the board mounting hole.</li>
	<li>When the external compass is plugged into the PX4IO boards I2C port, it is automatically detected and used and the internal compass is disabled.</li>
</ul>
<a href="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/06/PX4IOtopI2C.jpg"><img class="alignnone wp-image-1749" src="http://dev.ardupilot.com/wp-content/uploads/sites/6/2013/06/PX4IOtopI2C.jpg" alt="PX4IO I2C port" width="400" height="292" /></a>

Next connect with the Mission Planner and go to <strong>INITIAL SETUP | Mandatory Hardware | Compass</strong> and set the Orientation to <code>ROTATION_ROLL_180</code>.


<h2>Connecting to Erle-Brain2</h2>
<ul>
	<li>Connect GPS 6 pin DF13 connector to the port labeled as "UART"</li>
        <li>Connect Compass 4 pin DF13 connector to one of the ports labeled as "I2C"</li>
</ul>
<a href="http://planner.ardupilot.com/wp-content/uploads/sites/5/2015/12/ErleBrain2_GPScompass.jpg"><img class="alignnone wp-image-1749" src="http://planner.ardupilot.com/wp-content/uploads/sites/5/2015/12/ErleBrain2_GPScompass.jpg" alt="ErleBrain2 GPS" width="350" height="450" /></a>

An external compass is required (drivers are not yet available for the internal compass).

If using Copter 3.3 or higher or recent versions of Plane/Rover then this parameter should also be set:
<ul>
	<li>SERIAL4_PROTOCOL = 5</li>
</ul>
[note]The baud rate is set by the UBlox driver (setting <code>SERIAL4_BAUD = 38</code> is ignored).[/note]


<h1>Mounting the GPS Module</h1>
This module permits the GPS to be mounted separately from the flight control module so that it can have the best clear (view) of the sky and allows the compass to be distanced from interfering magnetic fields.

[tip]The recommended orientation is to mount the module with the arrow facing toward the front of the vehicle and in the same direction as the arrow on the autopilot.[/tip]

When mounting the GPS+Compass module:
<ul>
	<li>Place the module on the outside of your vehicle (in an elevated position if appropriate) with a clear view of the sky, as far as possible from the motors and ESCs, with the arrow facing forward.</li>
	<li>Distance the module from DC power wiring and the batteries by at least 10cm.  Use of <a href="http://store.jdrones.com/foldable_GPS_and_Compass_antenna_mast_p/mntgps01blk.htm" target="_blank">a GPS mast</a> is highly recommended.</li>
	<li>Place the module clear of nearby iron containing metallic objects. (Use nylon or non magnetic stainless steel hardware and nylon or aluminum standoffs to mount the module).</li>
	<li>Twist power and ground wires where possible.</li>
</ul>
<a href="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_sampleMoutning.jpg"><img class="alignnone size-medium wp-image-2606" src="http://planner.ardupilot.com/wp-content/uploads/sites/5/2013/06/GPS_sampleMoutning-300x200.jpg" alt="GPS_sampleMoutning" width="300" height="200" /></a>
<h1>Setup in Mission Planner</h1>
<a href="common-compass-calibration-in-mission-planner">Compass Calibration in Mission Planner</a> explains the simplest way to calibrate a compass mounted in the recommended orientation (arrows for autopilot and compass facing to front of vehicle).

<a href="common-compass-setup-advanced">Advanced Compass Setup</a> contains more detailed instructions for calibrating a compass if, for example, it has been mounted at some other orientation.
<h1>LED Indicators</h1>
The 3DR GPS+Compass module has two LED indicators: one for power (solid red) and one for GPS lock (flashing blue).
<table>
<tbody>
<tr>
<td><strong>LEDs:</strong></td>
<td><strong>Behavior:</strong></td>
</tr>
<tr>
<td>Power</td>
<td>Solid <span style="color: #ff0000"><strong>red</strong></span> when powered</td>
</tr>
<tr>
<td>GPS lock</td>
<td>Flashing <strong><span style="color: #0000ff">blue</span></strong> when 3D GPS lock acquired</td>
</tr>
</tbody>
</table>
<h1>Advanced Configuration</h1>
Advanced configuration of the UBlox GPS's internal settings is documented in <a href="common-ublox-gps">UBlox GPS Configuration</a>.